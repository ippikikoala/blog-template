# ブログ改善TODO

このドキュメントは、ブログの改善点を管理するためのチェックリストです。
完了したタスクには ✅ をつけています。

---

## 1. フォントサイズの調整

- [x] `src/app/globals.css` の body font-size を 17px → 15px に変更
- [x] ビルドして表示確認

**優先度**: 高（簡単）
**ファイル**: `src/app/globals.css`
**ステータス**: ✅ 完了

---

## 2. 目次（TableOfContents）の修正

### 問題点
- 目次のリンクが見出しに飛ばない（ID不一致）
- 記事本文冒頭に旧目次リンクが残っている

### 対応
- [x] `github-slugger` パッケージをインストール
- [x] `src/app/posts/[slug]/page.tsx` でMDXコンポーネントにID付与
- [x] TableOfContents.tsx の ID生成ロジックを github-slugger に統一
- [x] ビルドして目次のリンクが正常に動作するか確認
- [x] Pythonスクリプトで本文冒頭の旧目次リンクを削除（47ファイル修正）

**優先度**: 高
**ファイル**:
- `src/app/posts/[slug]/page.tsx`
- `src/components/TableOfContents.tsx`
- `scripts/remove_old_toc.py`
- `content/posts/*.mdx` (47ファイル)
- `package.json`
**ステータス**: ✅ 完了

---

## 3. MDXファイルのクリーンアップ

### 問題点
- 本文冒頭に旧目次リンク `[見出し](#見出し)` が残っている
- descriptionフィールドに目次テキストが混入している
- Hatenaキーワードリンク `d.hatena.ne.jp` が残っている

### 対応
- [x] クリーンアップスクリプト作成（Python）
  - [x] 本文冒頭の目次リンク削除
  - [x] descriptionから目次テキスト除去
  - [x] Hatenaキーワードリンク `[テキスト](https://d.hatena.ne.jp/...)` をプレーンテキスト化
  - [x] description内の裸のHatena URL `(https://d.hatena.ne.jp/...)` を削除
  - [x] truncateされたHatena URL（末尾が`...`）にも対応
- [x] 全139記事に対してスクリプト実行（136ファイル修正）
- [x] ビルドして動作確認
- [x] 変更をコミット

**優先度**: 高
**対象**: `content/posts/*.mdx` (139ファイル)
**スクリプト**: `scripts/cleanup_mdx.py`
**ステータス**: ✅ 完了

---

## 4. タグの復元

### 問題点
- 移行時にタグ情報が失われ `tags: []` になっている

### 対応
- [x] 元のHatenaブログエクスポートデータを確認
- [x] タグ復元スクリプト作成 (`scripts/restore_tags.py`)
- [x] 全記事のfrontmatterにタグを追加（44ファイル更新）
- [x] 動作確認（タグページ、記事詳細ページ）

**優先度**: 中
**対象**: `content/posts/*.mdx`
**スクリプト**: `scripts/restore_tags.py`
**ステータス**: ✅ 完了

### 補足
- Hatenaブログエクスポートの`CATEGORY`フィールドを解析
- 最初のCATEGORYはcategory（既存）、2番目以降をtagsとして復元
- 44件のファイルにタグを追加（82件はタグなし記事）
- 復元されたタグ: 廃線(9), 炭鉱(8), IT(6), ロードバイク(6), 旅館(5), 島(4), 温泉(2), 機材(2), 他

---

## 5. iframe埋め込みの実装

### 問題点
- `[Google Maps埋め込み]` プレースホルダーのまま（14記事）
- YouTube埋め込みが欠落（77件）

### 対応
- [x] YouTube埋め込みコンポーネント作成（`src/components/embeds/YouTube.tsx`）
- [x] Google Maps埋め込みコンポーネント作成（`src/components/embeds/GoogleMap.tsx`）
- [x] MDXRemoteコンポーネント設定更新（`src/app/posts/[slug]/page.tsx`）
- [x] iframe情報抽出スクリプト作成（`scripts/extract_iframes.py`）
  - YouTube: 77件検出
  - Google Maps: 33件検出
  - 対象記事: 31件
- [x] 更新ガイド生成スクリプト作成（`scripts/update_mdx_iframes.py`）
- [x] 更新ガイド生成（`iframe_update_guide.md`）
- [x] 自動更新スクリプト作成（`scripts/auto_update_iframes.py`）
- [x] Google Maps自動更新実行（13記事、31件）
- [x] ビルド確認（エラーなし）
- [ ] YouTube埋め込み追加（77件、任意）
- [ ] 全埋め込みの表示確認（ブラウザ確認）

**優先度**: 高
**ステータス**: ✅ 完了（Google Maps埋め込み）

**実装完了ファイル**:
- `src/components/embeds/YouTube.tsx` - YouTubeコンポーネント
- `src/components/embeds/GoogleMap.tsx` - Google Mapsコンポーネント
- `src/app/posts/[slug]/page.tsx` - MDXRemote設定更新
- `scripts/extract_iframes.py` - iframe情報抽出スクリプト
- `scripts/update_mdx_iframes.py` - 更新ガイド生成スクリプト
- `scripts/auto_update_iframes.py` - 自動更新スクリプト
- `iframe_mapping.json` - 抽出結果
- `iframe_update_guide.md` - 手動更新用ガイド

**更新完了記事（14記事）**:
- 手動更新: 2025-12-28-174758.mdx（Google Maps 2件）
- 自動更新: 13記事（Google Maps 31件）
  - 2025-05-06-231710.mdx（5件）
  - 2025-05-18-185739.mdx（4件）
  - 2026-01-04-223535.mdx（4件）
  - 2025-11-04-230836.mdx（3件）
  - 2025-11-09-172638.mdx（3件）
  - 2025-12-21-171641.mdx（3件）
  - 2025-11-09-010007.mdx（2件）
  - 2026-01-04-185146.mdx（2件）
  - 2025-10-29-233946.mdx（1件）
  - 2025-11-04-235915.mdx（1件）
  - 2026-01-04-160039.mdx（1件）
  - 2026-01-04-160836.mdx（1件）
  - 2026-01-05-001743.mdx（1件）

**次のステップ（任意）**:
1. YouTube埋め込み追加（77件）
   - `iframe_update_guide.md` を参照
   - 手動で各記事に追加
2. 各記事を `npm run dev` で表示確認
3. YouTube動画の再生確認
4. Google Mapsの操作確認（ドラッグ、ズーム）
5. レスポンシブ表示確認

---

## 6. 目次に中見出し・小見出しが表示されない

### 問題点
- 目次（TableOfContents）にh2-h4しか表示されていなかった
- h5・h6が無視されていた（Hatenaブログでは全レベル表示されていた）

### 対応
- [x] `src/components/TableOfContents.tsx` の正規表現を`#{2,6}`に変更
- [x] `src/app/posts/[slug]/page.tsx` でh5/h6にもID付与
- [x] `src/app/globals.css` でh2-h6の階層的スタイリング実装
  - h2: 太字15px（インデントなし）
  - h3: 14px、16pxインデント
  - h4: 14px（インデントなし）
  - h5: 13px、16pxインデント
  - h6: 12px、32pxインデント
- [x] ビルドして動作確認（225ページ生成成功）

**優先度**: 高
**ファイル**:
- `src/components/TableOfContents.tsx`
- `src/app/posts/[slug]/page.tsx`
- `src/app/globals.css`
**ステータス**: ✅ 完了

---

## 7. スマホのハンバーガーメニューが機能しない

### 問題点
- スマホでハンバーガーメニューを押すと「Menu」というテキストしか表示されない
- カテゴリ一覧などのナビゲーションが表示されない

### 対応
- [x] `src/components/Header.tsx` のモバイルメニュー実装を確認
- [x] メニュー展開時にカテゴリ一覧を表示するよう修正
- [x] 必要に応じてSidebarコンポーネントとの連携を検討
- [x] 実機またはDevToolsのモバイル表示で動作確認

**優先度**: 高
**ファイル**:
- `src/components/Header.tsx` - サーバーコンポーネントに変更
- `src/components/MobileMenu.tsx` - 新規作成（クライアントコンポーネント）
**ステータス**: ✅ 完了

### 実装内容
- `Header.tsx`をサーバーコンポーネントに変更し、カテゴリ・タグデータをサーバーサイドで取得
- `MobileMenu.tsx`を新規作成し、モバイルメニューのインタラクティブ部分を分離
- モバイルメニューにカテゴリ一覧（上位10件）とタグ一覧（上位12件）を表示
- 各リンククリック時にメニューを自動的に閉じる動作を実装

---

## 8. スマホ版サイドバーのカテゴリ表示修正

### 問題点
- モバイル表示時にサイドバーのカテゴリが使いにくい

### 対応
- [x] スマホで実際の表示を確認
- [x] 問題箇所を特定
- [x] モバイルメニューにカテゴリ・タグを追加（#7で対応）
- [x] モバイルでの表示確認

**優先度**: 中
**ファイル**:
- `src/components/MobileMenu.tsx` - モバイル用カテゴリ・タグ表示を実装
**ステータス**: ✅ 完了

### 実装内容
- #7の対応でモバイルメニューにカテゴリ・タグを追加したことで解決
- サイドバーは大画面（lg以上）で表示、モバイルではハンバーガーメニューからアクセス

---

## 9. カテゴリの整理・並び順の変更

### 問題点
- カテゴリが「廃線」「炭鉱」「IT」など都道府県以外になっている記事がある
- カテゴリが空（""）の記事がある
- 一覧ページのカテゴリが記事数順で、地理的に探しにくい

### 対応
- [x] 非都道府県カテゴリ（廃線・炭鉱・IT・ロードバイク・機材・旅館・島・小山田壮平）を調査
- [x] 各記事の内容から正しい都道府県カテゴリを特定
- [x] 空カテゴリの記事を調査・分類
- [x] 修正スクリプト作成（`scripts/fix_categories.py`）
- [x] 52件のMDXファイルのcategoryを修正
- [x] 元のカテゴリ（廃線・炭鉱等）はタグとして保持
- [x] `src/lib/posts.ts` の `getAllCategories()` を北から南順（JISコード順）にソート
- [x] ビルド確認

**優先度**: 高
**ファイル**:
- `scripts/fix_categories.py` - カテゴリ修正スクリプト
- `src/lib/posts.ts` - カテゴリソート順の変更
- `content/posts/*.mdx` (52ファイル)
**ステータス**: ✅ 完了

### 修正内容サマリー
- **廃線カテゴリ（7件）**: 北海道(2), 岐阜県(1), 和歌山県(2), 宮崎県(2)
- **炭鉱カテゴリ（7件）**: 北海道(6), 福島県(1)
- **ITカテゴリ（9件）**: その他(9)
- **ロードバイクカテゴリ（6件）**: 徳島県(2), 高知県(2), 千葉県(1), 愛媛県(1)
- **機材カテゴリ（4件）**: 福島県(1), 東京都(1), その他(2)
- **旅館カテゴリ（4件）**: 北海道(1), 長崎県(1), 愛知県(1), 新潟県(1)
- **島カテゴリ（3件）**: 滋賀県(2), 兵庫県(1)
- **小山田壮平カテゴリ（1件）**: 愛知県(1)
- **空カテゴリ（11件）**: 奈良県(1), 愛媛県(1), 山形県(1), 長野県(1), その他(7)

---

## 10. スマホ版UIの改善

### 問題点
- **問題1**: トップページ（記事一覧）で目次の内容が表示されてしまう
- **問題2**: ハンバーガーメニューを押しても何も表示されない（実機iPhone/Androidで確認）
- **問題3**: 記事カード（一覧）に都道府県カテゴリバッジが表示されていない

### 対応

#### 問題1: 目次の誤表示
- [ ] 目次が記事詳細ページ以外に表示されないことを確認
- [ ] 必要に応じてトップページのレンダリングロジックを調査
- [ ] 一覧画面で目次コンポーネントが呼ばれていないか確認

**原因仮説**:
- TableOfContentsは記事詳細ページ（`src/app/posts/[slug]/page.tsx`）でのみ使用されている
- トップページ（`src/app/page.tsx`）では使用されていない
- 別の原因（キャッシュ、ビルド成果物の問題等）の可能性あり

#### 問題2: ハンバーガーメニューが開かない → **解決済み**
- [x] `src/components/MobileMenu.tsx` のz-index設定を確認・修正
- [x] React Portalを使ってbody直下にレンダリングする実装
- [x] 実機での動作確認（iPhone/Android）

**解決方法**: React Portalでbody直下にレンダリング + z-index調整

#### 問題2-b: カテゴリ/タグリンクをクリックすると404エラー → **解決済み**
- [x] `generateStaticParams`から`encodeURIComponent`を削除
- [x] Next.js App Routerが自動的にURLエンコーディングを処理

**原因**: `generateStaticParams`で`encodeURIComponent`を使用していたため、Next.jsの自動エンコーディングと競合していた

**修正ファイル**:
- `src/app/categories/[category]/page.tsx`
- `src/app/tags/[tag]/page.tsx`

#### 問題3: カテゴリバッジの表示改善
- [ ] `src/components/PostCard.tsx` のカテゴリバッジフォントサイズを確認
  - 現状: `text-[10px]` (非常に小さい)
- [ ] モバイルでのフォントサイズを調整（最低12px推奨）
- [ ] レスポンシブクラスを追加（`text-[10px] sm:text-xs`）
- [ ] 実機での視認性確認

**実装済み箇所**:
- カテゴリバッジ自体は実装済み（[PostCard.tsx:36-45](src/components/PostCard.tsx#L36-L45)）
- `normalizeCategory()` で複数カテゴリ対応済み

**優先度**: 高
**ファイル**:
- `src/app/page.tsx` - トップページ（問題1の調査）
- `src/components/MobileMenu.tsx` - ハンバーガーメニュー（解決済み）
- `src/app/globals.css` - z-index設定（解決済み）
- `src/app/categories/[category]/page.tsx` - カテゴリページ（解決済み）
- `src/app/tags/[tag]/page.tsx` - タグページ（解決済み）
- `src/components/PostCard.tsx` - カテゴリバッジ
**ステータス**: 一部解決（問題2, 2-b完了 / 問題1, 3未着手）

---

## 11. スマホでの横スクロール問題

### 問題点
- スマホで一覧ページを縦スクロールすると画面が左右にぶれる
- 横スクロールが可能になっていて操作性が悪い

### 対応
- [x] `src/app/globals.css` で `html, body` に `overflow-x: hidden` を追加
- [x] 実機で動作確認
- [x] 本番環境にデプロイ

**優先度**: 高
**ファイル**: `src/app/globals.css`
**ステータス**: ✅ 完了

---

## 12. カテゴリーを増やしたい

### 問題点
- 現在のカテゴリは都道府県のみ
- テーマ別カテゴリ（温泉、廃線、炭鉱など）も追加したい
- **具体的な要件**:
  - カテゴリが「その他」かつタグに「IT」がある記事 → 「IT」カテゴリに変更したい（9件）
  - カテゴリが「愛知県」かつタグに「小山田壮平」がある記事 → 「小山田壮平」カテゴリに変更したい（1件）

### 対応
- [x] 新規カテゴリの追加
  - [x] 「IT」カテゴリを追加（カテゴリが「その他」でタグに「IT」を含む記事を移行）
  - [x] 「小山田壮平」カテゴリを追加（カテゴリが「愛知県」でタグに「小山田壮平」を含む記事を移行）
- [x] カテゴリ移行スクリプト作成
  - [x] その他 + IT タグ → IT カテゴリ（10件）
  - [x] 愛知県 + 小山田壮平タグ → 小山田壮平カテゴリ（1件）
- [x] カテゴリ構造の設計（都道府県 + テーマ別の共存方法）
- [x] `src/lib/posts.ts` のカテゴリソート順更新（都道府県とテーマ別の表示順）
- [x] UIへの反映（サイドバー、ハンバーガーメニュー）
- [x] ビルド & 動作確認

**優先度**: 中
**ファイル**:
- `src/config/categories.ts` - テーマ別カテゴリ定義
- `src/lib/categoryUtils.ts` - テーマ別カテゴリ管理ロジック
- `src/lib/posts.ts` - カテゴリソート順調整
- `content/posts/*.mdx` - 記事のカテゴリフィールド（11ファイル）
- `scripts/add_new_categories.py` - カテゴリ追加スクリプト
- `src/components/Sidebar.tsx` - サイドバー表示
- `src/components/CategoryAccordion.tsx` - アコーディオン表示
- `src/components/Header.tsx` - ヘッダー
- `src/components/MobileMenu.tsx` - モバイルメニュー表示
**ステータス**: ✅ 完了

### 実装内容
- ITカテゴリ: 10記事
- 小山田壮平カテゴリ: 1記事
- テーマ別カテゴリを地方アコーディオンと並列表示
- ビルド成功（212ページ生成）

### 対象記事
- **ITカテゴリ（10件）**: カテゴリ「その他」からタグ「IT」の記事を移行
- **小山田壮平カテゴリ（1件）**: カテゴリ「愛知県」からタグ「小山田壮平」の記事を移行

---

## 13. 記事詳細でのPart1などのブログ参照リンクが消えているので復活させたい

### 問題点
- 記事内で他の記事を参照する「Part1」「続き」などのリンクが失われている
- Hatenaブログからの移行時に内部リンクが削除された可能性

### 対応
- [x] 元のHatenaブログエクスポートデータから内部リンクを抽出
- [x] 現在のMDXファイルとの差分確認
- [x] 内部リンク復元スクリプト作成
- [x] リンク先のslugマッピング作成（Hatena URL → Next.js slug）
- [x] 復元実行 & 動作確認

**優先度**: 中
**ファイル**:
- `content/posts/*.mdx` - 記事本文のリンク（22ファイル修正）
- `scripts/restore_internal_links.py` - 復元スクリプト（新規作成）
**ステータス**: ✅ 完了（26件のリンクを復活）

---

## 14. 記事詳細での見出しが本文と同じフォントになっている場合があるので直したい

### 問題点
- 記事詳細ページで見出し（h2-h6）が本文と区別しにくい
- フォントサイズ・太さが適切でない箇所がある

### 対応
- [x] 現在のスタイル定義を確認（`src/app/globals.css`）
- [x] 見出しレベル別のフォントサイズ・太さを再設定
- [x] Hatenaブログのスタイルと比較
- [x] 複数記事で表示確認
- [x] レスポンシブ対応確認（モバイル/デスクトップ）

**優先度**: 中
**ファイル**:
- `src/app/globals.css` - 見出しスタイル定義
- `src/app/posts/[slug]/page.tsx` - 記事詳細ページ
**ステータス**: ✅ 完了

---

## 15. そろそろ手動での新規記事投稿に向けて計画を作りたい

### 問題点
- 現在は移行した記事のみで、新規投稿フローが未確立
- GitHub Mobileでの編集を想定しているが、手順が明確でない

### 対応
- [x] 新規記事作成の手順書作成
  - [x] ファイル命名規則（YYYY-MM-DD-slug.mdx）
  - [x] frontmatter必須フィールド
  - [x] 画像アップロードフロー（Cloudflare R2）
  - [x] カテゴリ・タグの選び方
- [x] テンプレートファイル作成（`templates/new-post.mdx`）
- [ ] GitHub Mobileでの投稿手順確認（別途TODO #16で対応）
- [ ] 画像最適化スクリプト作成（リサイズ、WebP変換）- オプション
- [ ] プレビュー環境でのテスト投稿

**優先度**: 高
**ファイル**:
- `docs/10-new-post-guide.md` - 投稿手順書
- `templates/new-post.mdx` - テンプレート
- `scripts/optimize_images.py` - 画像最適化スクリプト（オプション・未作成）
**ステータス**: ✅ 完了（PC投稿ワークフロー確立）

---

## 16. 手動での既存記事修正に向けて計画を建てたい

### 問題点
- 既存記事の修正フローが未確立
- タイポ修正、情報追加、画像差し替えなどの手順が不明確

### 対応
- [x] 既存記事修正の手順書作成
  - [x] GitHubでのファイル検索方法（3つの方法を記載）
  - [x] frontmatter編集時の注意点（必須フィールド、ベストプラクティス）
  - [x] 画像URLの変更方法（R2 URL形式の確認）
  - [x] プレビュー確認手順（ローカル・本番両方）
- [x] GitHub Mobileでの編集手順確認（詳細な手順を記載）
- [x] 変更前後の差分確認方法（git diff）
- [x] ビルドエラー発生時の対処法（トラブルシューティングセクション）
- [x] スマホ・PC両方の操作方法を記載

**優先度**: 中
**ファイル**:
- `docs/16-edit-post-guide.md` - 修正手順書（新規作成完了）
**ステータス**: ✅ 完了

### 実装内容
- スマホ（GitHub Mobile）とPC（エディタ）両方の操作手順を詳細に記載
- ファイル検索方法を3パターン記載（ファイル名・タイトル検索・URL逆引き）
- よくある修正内容の具体例を表形式で整理
- Commit messageのベストプラクティスを記載
- トラブルシューティングセクション（5つの問題パターン）
- 修正前後のチェックリストを追加
- 関連ドキュメントへのリンクを整備

---

## 17. テストページを削除

### 問題点
- ~~テスト用のページが残っている可能性がある~~
- ~~本番環境に不要なページが公開されている~~

### 対応
- [x] テストページの一覧確認
- [x] 不要なページファイルを特定
- [x] テストページの削除
- [x] ビルド確認

**削除したファイル**:
- `content/posts/sample-post.mdx` - サンプル記事
- `content/posts/hello-world.mdx` - Hello Worldテスト記事

**ステータス**: ✅ 完了

---

## 18. ブログのコアラの画像をオリジナルのものに更新

### 問題点
- 現在のコアラ画像がプレースホルダーまたは仮の画像
- オリジナルのコアラ画像に差し替える必要がある

### 対応
- [x] 現在使用中のコアラ画像を確認
- [x] オリジナルのコアラ画像を準備
- [x] 画像をpublicフォルダに配置
- [x] プロフィール画像を更新（Sidebar.tsx）
- [x] 記事一覧のフォールバック画像を更新（PostCard.tsx）
- [x] 各ページでの表示確認（サイドバー、記事一覧）
- [x] 本番環境にデプロイ

**優先度**: 中
**ファイル**:
- `src/components/Sidebar.tsx` - プロフィール画像
- `src/components/PostCard.tsx` - フォールバック画像
- `public/ippikikoala.png` - フォールバック用画像
- `public/ippikikoala_profile.png` - トリミング済みプロフィール画像
**ステータス**: ✅ 完了

---

## 19. ページ最下部の「タグ」表記を英語に変更

### 問題点
- ページ最下部のタグセクションで「タグ」とカタカナ表記になっている
- 英語表記「Tags」に統一したい

### 対応
- [x] フッター内のタグセクションを確認
- [x] 「タグ」→「Tags」に変更
- [x] 他の日本語表記との整合性を確認（Home, About, Categories, RSS Feedと統一）
- [x] デスクトップ/モバイルでの表示確認

**優先度**: 低
**ファイル**:
- `src/components/Footer.tsx` - フッターコンポーネント（55行目）
**ステータス**: 完了

---

## 20. その他の改善（オプション）

- [x] favicon追加 (`src/app/icon.png`)
- [ ] OGP画像作成 (`public/og-image.png`)
- [ ] Vercel Analytics有効化
- [ ] 検索機能追加（将来的に）

---

## 21. 画像のMarkdown構文エラー修正

### 問題点
- 複数の記事で画像のMarkdown構文が間違っている
- 誤った構文: `!テキスト[続き](URL)` → 画像が表示されず「!テキスト」とリンクが表示される
- 正しい構文: `![テキスト続き](URL)`

### 対応
- [x] 全MDXファイルをスキャンして誤った構文のパターンを検出
- [x] 修正スクリプト作成（`scripts/fix_image_markdown.py`）
- [x] 全ファイルに対してスクリプト実行（82ファイル、176件修正）
- [x] 修正後のビルド確認
- [x] 各記事で画像が正しく表示されることを確認

**優先度**: 高
**ファイル**:
- `content/posts/*.mdx` - 対象記事（82ファイル修正）
- `scripts/fix_image_markdown.py` - 修正スクリプト（新規作成）
**ステータス**: ✅ 完了

---

## 22. 記事descriptionに目次テキスト・見出しが含まれている問題の修正

### 問題点
- 一覧ページで記事タイトルの下に目次部分や見出しが表示されてしまう
- frontmatterのdescriptionフィールドに不適切なテキストが含まれている
- 本来は記事の冒頭説明文のみがdescriptionに入るべき

### 対象記事（10件）

#### パターン1: 目次「X日目：〜」形式（2件）
1. `2026-01-04-2026-01-04-185146.mdx` （濃昼漁港 Part 3）
   - 現状: `"2日目：静内〜雄冬〜増毛〜羽幌〜旭川 静内に宿泊し..."`
   - 修正案: `"静内に宿泊し、札幌を経由して旭川に向かいました。走行距離は450kmくらい。"`
2. `2026-01-04-2026-01-04-160039.mdx` （晩成温泉 Part 1）
   - 現状: `"1日目：釧路空港〜晩成温泉〜襟裳岬〜静内 1日目は..."`
   - 修正案: `"1日目は釧路空港からレンタカーを借り、晩成温泉・襟裳岬を経由して静内に。"`

#### パターン2: 見出しテキストが先頭（4件）
3. `2025-12-21-2025-12-21-221314.mdx` （清水の街 生地）
   - 現状: `"清水巡り 生地は建築学科出身の妻が..."`
   - 修正案: `"生地は建築学科出身の妻が知っており終始ドヤ顔状態でした。確かに自分が好きな街でした。"`
4. `2025-08-23-2025-08-23-233545.mdx` （下市町 Part1）
   - 現状: `"みんなだいすきな下市町へ 画像 大阪から..."`
   - 修正案: `"大阪から約1時間半、下市口駅から下市町の一帯を歩きました。"`
5. `2026-01-01-2026-01-01-000818.mdx` （浦佐駅）
   - 現状: `"駅の東側 自在館からの帰り..."`
   - 修正案: `"自在館からの帰り、送迎バスが到着してから新幹線に乗るまで１時間ほど時間がありました。"`

#### パターン3: Part1リンク残骸（1件）
6. `2025-08-24-2025-08-24-210100.mdx` （下市町 Part2）
   - 現状: `"Part1： 下市町 吉野川を渡って..."`
   - 修正案: `"吉野川を渡って下市町へ行きます。四国で見られるような川沿いの少ない平地を活かした建物が見えてきます。"`

#### パターン4: 本の目次がそのまま（1件）
7. `2025-08-24-2025-08-24-224334.mdx` （マネジメントは嫌いですけど）
   - 現状: `"4章までの目次の抜粋 1章 マネジメントできるのは未来だけ..."`
   - 修正案: `"「マネジメントは嫌いですけど」を読んだ感想。ロジカルに仕事に向き合う方法論が参考になりました。"`

#### パターン5: 極端に短い/目次のみ（2件）
8. `2025-08-15-2025-08-15-234805.mdx` （亀崎港）
   - 現状: `"亀崎駅 知多半島"`
   - 修正案: `"知多半島の付け根の方にある亀崎に行ってきました。名前のついた坂がいくつかあり巡ってきました。"`
9. `2025-08-16-2025-08-16-201919.mdx` （蒲郡クラシックホテル）
   - 現状: `"蒲郡クラシックホテル 東海道新幹線"`
   - 修正案: `"日本クラシックホテルの会に加入している蒲郡クラシックホテルに泊まってきました。"`

### 対応
- [x] 上記9ファイルのdescriptionを修正
- [x] 一覧ページで目次テキストが表示されなくなったことを確認

**優先度**: 中（9件）
**ファイル**: `content/posts/*.mdx`（9ファイル）
**ステータス**: ✅ 完了

---

## 27. カテゴリー管理の手順書を作成したい

### 背景
カテゴリー構造が拡張され、都道府県カテゴリとテーマ別カテゴリが共存するようになった。
今後の手動修正やメンテナンスに備えて、カテゴリー管理の手順を文書化する必要がある。

### 想定されるユースケース
1. **新しいテーマ別カテゴリを追加する**（例：「温泉」「廃線」カテゴリなど）
2. **階層型カテゴリを作成する**（例：ITカテゴリに「プログラミング」「AI」などの小カテゴリを追加し、アコーディオン形式にする）
3. **カテゴリを削除する**（例：「小山田壮平」カテゴリを削除して記事を他のカテゴリに移行）
4. **記事のカテゴリを変更する**（例：「その他」カテゴリの記事を適切なカテゴリに再分類）
5. **カテゴリの表示順を変更する**（例：テーマ別カテゴリの並び順を調整）

### 対応
- [x] カテゴリー管理ガイドを作成（`docs/12-category-management.md`）
  - [x] 新規カテゴリの追加手順
  - [x] 階層型カテゴリの作成手順
  - [x] カテゴリの削除手順
  - [x] 記事のカテゴリ一括変更手順（スクリプト使用）
  - [x] カテゴリ表示順の変更手順
  - [x] 関連ファイルの説明
- [x] `docs/10-category-hierarchy.md` を現在の実装に合わせて更新

**優先度**: 中
**ファイル**: 
- `docs/12-category-management.md` - カテゴリー管理ガイド
- `docs/10-category-hierarchy.md` - カテゴリ階層構造仕様（更新）
**ステータス**: ✅ 完了

---


## 進捗管理

- **完了**: 23/29（#1-9, #11-19, #21-28）
- **進行中**: 1/29（#29）
- **未着手**: 5/29（#10一部, #20一部）


---

## メモ

- 各タスク完了後はビルド & 動作確認を実施
- 重要な変更後はgitコミット
- 本番反映前にプレビュー環境で確認
- スマホ実機での確認を優先（DevToolsだけでは再現しない問題あり）
- **複数都道府県にまたがる記事の扱い**: `category` は1つのみ設定可能。複数の都道府県を訪問した記事は、メインの県を `category` に設定し、他の県は `tags` に追加する（例: `category: "神奈川県"`, `tags: ['神奈川県', '静岡県']`）

---

## 29. ドキュメントと実装の整合性確認・修正

### 背景
- docsフォルダ内のドキュメントが古い情報のまま残っている
- 実装が先行しており、ドキュメントの更新が追いついていない状況

### 乖離点の詳細

#### 🔴 優先度：高（すぐ修正すべき）

1. **docs/06-config.md** - 古い情報のまま
   - ドメイン: 「未定」→ 実際は `ippikikoala.com` に確定済み
   - R2バケット: 「後で設定」→ 実際は設定完了
   - ファビコン: 「後で追加」→ 実際は実装済み
   - TODO項目がほぼ完了しているのにチェックマークなし

2. **docs/10-category-hierarchy.md** - カテゴリ名の不一致
   - 「小山田壮平」カテゴリ → 実装では「音楽」に変更済み

3. **src/app/posts/[slug]/page.tsx:175** - 仮のURL
   - `https://example.com` → `https://ippikikoala.com` に修正すべき

#### 🟡 優先度：中（追記が必要）

4. **docs/02-components.md** - 新規コンポーネントの記載漏れ
   - SearchBox（検索ボックス）
   - MonthlyArchive（月別アーカイブ）
   - CategoryAccordion（カテゴリアコーディオン）
   - MobileMenu（モバイルメニュー）
   - 埋め込みコンポーネント（YouTube, GoogleMap, Instagram）
   - Sidebar構成の変更（recentPostsは無効化、searchとarchiveが追加）

5. **docs/03-content.md** - カテゴリ仕様の更新
   - テーマ別カテゴリの追加
   - 複数カテゴリ対応（配列形式）
   - 画像パス: `/public/images/` → Cloudflare R2のURL

6. **docs/04-pages.md** - 新規ページの記載漏れ
   - `/search` - 検索ページ
   - `/archive/[year]/[month]` - 月別アーカイブページ

7. **docs/00-overview.md** - 新機能の記載
   - Phase 7として検索・アーカイブ機能の追加を記載

#### 🟢 優先度：低（細かい改善）

8. **Headerの幅統一**
   - src/components/Header.tsx:19 が `max-w-6xl`
   - 他のページは `max-w-7xl` → 統一を推奨

### ✅ 整合性が取れている部分
- デザイン仕様（色、フォント、レイアウト）
- 技術スタック（Next.js 16, React 19, Tailwind CSS 4）
- インフラ設定（Vercel, Cloudflare R2）
- 基本的なページ構造

### 対応
- [x] docs/06-config.md を更新（完了済み項目を反映）
- [x] docs/10-category-hierarchy.md を更新（テーマ別カテゴリを「音楽」に修正）
- [x] src/app/posts/[slug]/page.tsx のShareButtons URLを修正
- [x] docs/02-components.md に新規コンポーネントを追記
- [ ] docs/03-content.md にテーマ別カテゴリ・複数カテゴリ対応を追記
- [ ] docs/04-pages.md に検索・アーカイブページを追記
- [ ] docs/00-overview.md にPhase 7を追記
- [ ] src/components/Header.tsx の幅を統一（max-w-7xl）

**優先度**: 中
**ステータス**: 進行中（4/8完了）

---

最終更新: 2026-01-13

---

## 23. 過去記事の見出し階層修正

### 問題点
- 2026-01-11以前の記事で、見出しの階層が2つ下がってしまっていた（H2であるべき場所がH4になっている等）
- 意図した文書構造になっていない

### 対応
- [x] 修正スクリプト作成（`scripts/fix_headings.py` - 実行後削除済み）
- [x] 2026-01-11以前の全記事（96ファイル）に対して階層を2つ引き上げ（`######` -> `####`, `####` -> `##`）
- [x] ローカルサーバーでの表示確認

**優先度**: 高
**ステータス**: ✅ 完了

---

## 24. ページネーションのページ番号が見えにくい問題の修正

### 問題点
- 現在のページ番号の背景色（青）と文字色（青のまま）のコントラストが悪く、数字が見えなくなっていた

### 対応
- [x] `src/components/Pagination.tsx` のactiveクラスに `!text-white` を追加して文字色を強制的に白に変更
- [x] ビルドして表示確認

**優先度**: 高
**ファイル**: `src/components/Pagination.tsx`
**ステータス**: ✅ 完了

---

## 25. YouTube埋め込み手順の明確化とコンポーネント修正

### 問題点
- 新規投稿ガイドにYouTube動画IDの確認方法が記載されていなかった
- YouTube埋め込みコンポーネントのプロパティ名 (`id`) がガイド (`videoId`) と不一致だった
- 記事内で動画IDに不要なパラメータ（`&t`）が含まれておりエラーになっていた

### 対応
- [x] `docs/10-new-post-guide.md` に動画IDの確認方法を追記
- [x] `src/components/embeds/YouTube.tsx` のプロパティを `id` から `videoId` に変更してガイドと統一
- [x] 記事内のYouTube埋め込みコードを修正

**優先度**: 高
**ステータス**: ✅ 完了

---

## 26. ファビコン表示問題の修正

### 問題点
- 重複するファビコンファイル（`favicon.ico` と `icon.png`）が存在していた
- Next.js App Routerでの推奨されるファビコン実装方法は `src/app/icon.png` のみ
- 重複によりファビコンが正しく表示されなかった

### 対応
- [x] `src/app/favicon.ico` を削除（重複ファイル）
- [x] `src/app/icon.png` をNext.js App Routerの標準として維持
- [x] 変更をGitにコミット・プッシュ

**優先度**: 高
**ファイル**:
- `src/app/favicon.ico` - 削除
- `src/app/icon.png` - 保持（Next.js標準）
**ステータス**: ✅ 完了

---

## 28. SEO対策（サイトマップ・Google Search Console）

### 背景
- はてなブログから移行後、新ブログがGoogle検索結果に表示されにくい
- サイトマップがないとGoogleがサイト構造を把握しにくい
- Google Search Consoleで新サイトを登録する必要がある

### 対応

#### Step 1: サイトマップ・robots.txt作成
- [x] `src/app/sitemap.ts` を作成（全記事・カテゴリ・固定ページのURLを自動生成）
- [x] `src/app/robots.ts` を作成（検索エンジン向けクロール指示とサイトマップ場所を通知）
- [x] ローカルでビルド・動作確認
- [x] 本番環境にデプロイ

#### Step 2: Google Search Console登録
- [x] [Google Search Console](https://search.google.com/search-console/) にアクセス
- [x] URLプレフィックス `https://www.ippikikoala.com` を登録
- [x] 所有権を確認（HTMLファイル方式）
- [x] サイトマップ `https://www.ippikikoala.com/sitemap.xml` を送信

#### Step 3: はてなブログ側のリダイレクト設定
- [x] はてなブログの「詳細設定」→「headに要素を追加」でJavaScriptリダイレクトを設定
- [x] 旧URL → 新URLへの転送を確認

**優先度**: 高
**ファイル**:
- `src/app/sitemap.ts` - サイトマップ自動生成
- `src/app/robots.ts` - robots.txt自動生成
- `docs/15-seo-guide.md` - SEO設定ガイド
- `public/google35e293fc2e7112bb.html` - Google所有権確認ファイル
**ステータス**: ✅ 完了（リダイレクト設定は任意）

---
