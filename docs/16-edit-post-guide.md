# 既存記事修正ガイド（スマホ・PC両対応）

既に公開されているブログ記事を修正・更新するための手順書です。
**スマホ（iPhone）** と **PC** の両方の操作方法を記載しています。

---

## 📱 スマホ（GitHub Mobile）での修正

### 事前準備

- **アプリ**: [GitHub Mobile](https://github.com/mobile)をインストール
- **ログイン**: GitHubアカウントでサインイン済み
- **リポジトリアクセス**: `blog` リポジトリへのアクセス権限

---

### Step 1: 修正したい記事を探す

#### 方法A: ファイル名がわかる場合

1. **GitHub Mobileアプリ**を開く
2. リポジトリ **`blog`** を選択
3. **`content/posts/`** フォルダに移動
4. 記事ファイルをタップして開く
   - ファイル名形式: `YYYY-MM-DD-YYYY-MM-DD-HHMMSS.mdx`
   - 例: `2026-01-11-2026-01-11-210000.mdx`

#### 方法B: タイトルで記事を探す場合

1. **GitHub Mobileアプリ**を開く
2. リポジトリ **`blog`** を選択
3. 右上の **🔍 検索アイコン**をタップ
4. **検索ボックス**に記事タイトルの一部を入力
   - 例: `"北海道温泉"`
5. **検索結果**から該当の `.mdx` ファイルをタップ

#### 方法C: 本番サイトのURLから記事を特定する

**本番URL**: `https://www.ippikikoala.com/posts/2026-01-11-2026-01-11-210000`

↓

**ファイル名**: `content/posts/2026-01-11-2026-01-11-210000.mdx`

1. URLの `/posts/` 以降の部分をコピー
2. GitHub Mobileで `content/posts/` フォルダ内を検索
3. 該当ファイルを開く

---

### Step 2: ファイルを編集する

1. **記事ファイル**を開いた状態で、右上の **✏️ 鉛筆アイコン（Edit file）** をタップ
2. **編集画面**に切り替わる
3. 修正したい箇所を編集
   - frontmatter（上部のYAML部分）
   - 本文（Markdown形式）
   - 画像URL
   - タグ・カテゴリ

#### よくある修正内容

| 修正内容 | 対象箇所 | 例 |
|----------|----------|-----|
| 誤字脱字 | 本文 | "温泉" → "温泉" |
| タイトル修正 | frontmatter `title:` | `title: "【北海道】温泉巡り Part1"` |
| 説明文変更 | frontmatter `description:` | `description: "新しい説明文"` |
| カテゴリ変更 | frontmatter `category:` | `category: "北海道"` |
| タグ追加 | frontmatter `tags:` | `tags: ['温泉', '秘湯', '旅館']` |
| 画像差し替え | frontmatter `image:` または本文 | `image: "https://pub-521ec77a6aeb44b18091baa73887e9b7.r2.dev/..."` |
| リンク追加 | 本文 | `[Part1はこちら](/posts/2026-01-10-...)` |

---

### Step 3: 変更を保存（Commit）

1. 編集が終わったら、画面下部の **"Commit changes"** ボタンをタップ
2. **Commit message**（変更内容の説明）を入力
   - 日本語でOK
   - 簡潔に何を変更したか記載
3. **"Commit to main"** を選択（デフォルト）
4. **"Commit"** ボタンをタップして確定

#### Commit messageの例

```
✅ 良い例:
- "誤字修正: 温泉→温泉"
- "タグ追加: 秘湯タグを追加"
- "画像差し替え: アイキャッチ画像を変更"
- "リンク追加: Part1へのリンクを追加"
- "カテゴリ修正: その他→北海道"

❌ 悪い例:
- "update" （何を更新したか不明）
- "修正" （何を修正したか不明）
- "" （空白）
```

---

### Step 4: 反映を確認

1. **Commit完了後、約1〜3分待つ**
   - Vercelが自動的にビルド・デプロイを実行
2. **本番サイト**を開く: https://www.ippikikoala.com
3. 該当記事を開いて、**変更が反映されているか確認**
   - 一覧ページのカード
   - 記事詳細ページ
   - 画像の表示
   - タグ・カテゴリ

#### デプロイ状況の確認方法（オプション）

1. **Vercelダッシュボード**にアクセス（PCから）
   - https://vercel.com/dashboard
2. **`blog` プロジェクト**を選択
3. **Deployments**タブで最新のデプロイ状況を確認
   - ✅ **Ready**: デプロイ成功
   - 🔄 **Building**: ビルド中（待つ）
   - ❌ **Error**: ビルド失敗（エラー内容を確認）

---

## 💻 PC（エディタ）での修正

PCで作業する場合は、より快適に編集できます。

### Step 1: リポジトリをクローン（初回のみ）

```bash
# まだクローンしていない場合
git clone https://github.com/your-username/blog.git
cd blog
npm install
```

### Step 2: 最新の状態に同期

```bash
# 他のデバイス（スマホ等）で編集した内容を取得
git pull origin main
```

### Step 3: ファイルを編集

```bash
# VS Code、Cursor などのエディタで開く
code content/posts/YYYY-MM-DD-YYYY-MM-DD-HHMMSS.mdx
```

好きなエディタで自由に編集してください。

### Step 4: ローカルでプレビュー（オプション）

```bash
# 開発サーバー起動
npm run dev
```

ブラウザで http://localhost:3000 を開いて変更を確認できます。

### Step 5: 変更をコミット・プッシュ

```bash
# 変更したファイルを確認
git status

# ステージング
git add content/posts/編集した記事.mdx

# コミット
git commit -m "Update: 記事タイトル - 修正内容の簡単な説明"

# プッシュ
git push origin main
```

### Step 6: 本番反映を確認

Vercelが自動デプロイを実行します（約1〜3分）。
https://www.ippikikoala.com で変更を確認してください。

---

## 🎯 修正時のベストプラクティス

### 1. 小さく、こまめにCommit

- **1つの修正ごとにCommit**する
- 複数の記事を一度に修正する場合は、記事ごとにCommit

**❌ NG（一度に大量修正）**:
```bash
git add content/posts/*
git commit -m "update"
```

**✅ OK（記事ごとにCommit）**:
```bash
git add content/posts/2026-01-11-xxx.mdx
git commit -m "誤字修正: 温泉の表記"

git add content/posts/2026-01-10-yyy.mdx
git commit -m "タグ追加: 秘湯タグ"
```

### 2. Commit messageは具体的に

| 修正内容 | Commit message |
|----------|----------------|
| 誤字脱字 | `誤字修正: 温泉→温泉` |
| タグ追加 | `タグ追加: 秘湯タグを追加` |
| 画像差し替え | `画像差し替え: アイキャッチ画像を変更` |
| 内容加筆 | `加筆: 温泉の詳細情報を追加` |
| リンク修正 | `リンク修正: Part1へのリンクを追加` |

### 3. frontmatterの必須フィールドを保持

以下のフィールドは**必ず残してください**（削除しない）:

```yaml
---
title: "記事タイトル"        # 必須
date: "2026-01-11"          # 必須
description: "記事の説明"    # 必須
category: "北海道"           # 推奨
tags: ['温泉', '秘湯']       # 推奨
---
```

### 4. 画像URLは必ず確認

- **R2のURL形式**: `https://pub-521ec77a6aeb44b18091baa73887e9b7.r2.dev/posts/...`
- **相対パス**: `/images/posts/...` （public/images/posts/に配置した場合）

画像URLが間違っていると、記事で画像が表示されません。

### 5. スマホ編集時の注意点

#### 推奨される修正内容（スマホ向き）
- ✅ 誤字脱字の修正（1〜2箇所）
- ✅ タグ・カテゴリの追加・変更
- ✅ 短いテキストの追加
- ✅ 画像URLの差し替え
- ✅ リンクの追加・修正

#### 避けるべき修正内容（PC推奨）
- ❌ 大量の本文加筆（長文入力）
- ❌ 複数記事の同時編集
- ❌ 複雑なMarkdown記法の追加（表、コードブロック等）
- ❌ frontmatter構造の大幅変更

---

## ⚠️ トラブルシューティング

### 問題1: Commitボタンが押せない

**原因**: 編集内容が保存されていない

**対処法**:
1. 編集画面で変更を加える
2. 変更が検出されると、Commitボタンがアクティブになる

---

### 問題2: Commitしたのにサイトに反映されない

**原因1**: ビルド中（まだ反映されていない）

**対処法**: 3〜5分待ってから再度確認

**原因2**: ビルドエラー（デプロイ失敗）

**対処法**:
1. Vercelダッシュボードでエラー内容を確認
2. よくあるエラー:
   - frontmatterの形式エラー（YAMLの構文ミス）
   - 画像URLの間違い
   - Markdownの構文エラー

**原因3**: `draft: true` になっている

**対処法**: frontmatterから `draft: true` を削除または `draft: false` に変更

---

### 問題3: 画像が表示されない

**原因**: 画像URLが間違っている

**対処法**:
1. Cloudflare R2ダッシュボードで正しいURLを確認
2. `https://pub-521ec77a6aeb44b18091baa73887e9b7.r2.dev/posts/...` 形式になっているか確認
3. ブラウザで画像URLを直接開いて、アクセスできるか確認

---

### 問題4: GitHub Mobileで記事が見つからない

**原因**: ファイル名やフォルダ階層の認識ミス

**対処法**:
1. `content/posts/` フォルダにいることを確認
2. 検索機能（🔍）を使って記事タイトルで検索
3. PC版GitHubで該当ファイルのパスを確認

---

### 問題5: 他のデバイスで編集した内容が見えない

**原因**: ローカルリポジトリが古い状態

**対処法**（PC）:
```bash
# 最新の状態を取得
git pull origin main
```

**対処法**（スマホ）:
1. GitHub Mobileアプリを再起動
2. リポジトリを開き直す（自動的に最新を取得）

---

## 📋 修正前チェックリスト

修正を始める前に、以下を確認してください:

- [ ] 修正対象の記事ファイルを特定した
- [ ] 修正内容が明確になっている
- [ ] 必要な画像は事前にアップロード済み（新規画像がある場合）
- [ ] frontmatterの必須フィールド（title, date, description）を削除しない

## 📋 修正後チェックリスト

修正・Commit後に、以下を確認してください:

- [ ] Commit messageを具体的に記載した
- [ ] Vercelのデプロイが完了した（約1〜3分待つ）
- [ ] 本番サイトで変更が反映されているか確認した
- [ ] 記事一覧ページでカードの表示を確認した
- [ ] 記事詳細ページで本文の表示を確認した
- [ ] 画像が正しく表示されているか確認した（新規画像がある場合）

---

## 🔗 関連ドキュメント

- [PC新規記事投稿ガイド](./12-new-post-guide.md) - 新規記事作成の手順
- [スマホ編集環境](./07-mobile-editing.md) - GitHub Mobileの基礎
- [コンテンツ仕様](./03-content.md) - frontmatterフィールド仕様
- [Cloudflare R2セットアップ](./08-cloudflare-r2.md) - 画像アップロード方法

---

## 💡 Tips

### GitHub Mobileの便利な機能

- **履歴確認**: Commits タブで過去の変更履歴を確認できる
- **差分表示**: Commitの詳細画面で、変更前後の差分を確認できる
- **通知**: デプロイ完了通知を受け取れる（GitHub通知設定）

### PCでの効率的な編集

- **エディタの拡張機能**:
  - VS Code: MDX拡張、Prettier（フォーマッタ）、Markdown Preview
  - Cursor: AI補完で効率的に編集
- **一括置換**: 複数記事で同じ修正をする場合
  - VS Codeの「検索と置換」機能を活用
- **git diff で変更確認**:
  ```bash
  git diff content/posts/記事ファイル.mdx
  ```

---

最終更新: 2026-01-12
